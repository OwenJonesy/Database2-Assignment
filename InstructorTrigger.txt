-- Create a trigger to update AmountDue based on EstimatedLessons
CREATE OR REPLACE FUNCTION UpdateAmountDue()
RETURNS TRIGGER AS $$
BEGIN
    UPDATE DrivingStudent
    SET AmountDue = NEW.EstimatedLessons * 40
    WHERE StudentID = NEW.StudentID;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Create a trigger that fires when an assessment is inserted or updated
CREATE TRIGGER UpdateAmountDueTrigger
AFTER INSERT OR UPDATE
ON Assessment
FOR EACH ROW
EXECUTE FUNCTION UpdateAmountDue();
